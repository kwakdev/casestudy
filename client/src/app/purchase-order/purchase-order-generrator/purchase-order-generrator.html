<mat-card>
  <mat-card-title align="center" style="margin: 1rem">Purchase Order Generator</mat-card-title>
  <mat-card-content>
    <form [formGroup]="reportForm" novalidate>
      <div style="display: flex">
        <mat-form-field style="width: 90%; margin: auto">
          <mat-label>Employee</mat-label>
          <mat-select
            required
            placeholder="Vendor"
            formControlName="vendorId"
            (selectionChange)="onVendorSelectionChange($event)"
          >
            @for (vendor of vendors(); track $index) {
            <mat-option [value]="vendor.id">
              {{ vendor.name }}
            </mat-option>
            }
          </mat-select>
          
        </mat-form-field>
      </div>
       @if (vendorsExpenses().length == 0 && reportForm.get('employeeId')?.value > 0) {
      <div style="display: flex; justify-content: center;">
        <mat-card-title>No Expenses</mat-card-title>
      </div>
      } @if (vendorsExpenses().length > 0) {
      <div style="display: flex">
        <mat-form-field style="width: 90%; margin: auto">
          <mat-label>Expenses</mat-label>
          <mat-select required placeholder="Expense" formControlName="expenseId" (selectionChange)="onExpenseSelectionChange($event)"
 >
            @for (expense of vendorsExpenses(); track $index) {
            <mat-option [value]="expense.id">
              {{ expense.name }}
            </mat-option>
            }


          </mat-select>
        </mat-form-field>
      </div>
      }
          @if(vendorsExpenses().length > 0) {

        <mat-form-field style="width: 90%; margin: auto; display: block;">
          <mat-label>Quantity</mat-label>
          <input
            matInput
            type="number"
            min="1"
            formControlName="qoh"
            placeholder="Enter Quantity"
          />
        </mat-form-field>
          }
    </form>
     @if(selectedExpenseId() !== "") {
      
    <div class="section">
      <button mat-raised-button type="button" style="color: green"  (click)="addExpense()" [disabled]="expenseAlreadyAdded()" >
        Add
      </button>
      <span style="flex: 1 1 auto"></span>
      
    </div>
      
    }	@if (reportTable.data.length > 0) {

    <div class="section">
      <h3>Expenses In Report</h3>
    </div>

    <div class="section">
      
      <table mat-table [dataSource]="reportTable">
      
        <!-- Header -->
        <tr mat-header-row *matHeaderRowDef="tableColumns; sticky: true"></tr>
        <!-- Row Template -->
        <tr mat-row *matRowDef="let expense; columns: tableColumns"></tr>
        <!-- Footer Row -->
        <tr mat-footer-row *matFooterRowDef="tableColumns"></tr>

        <!-- Date Column -->
        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef>
            <div align="center">Date</div>
          </th>
          <td mat-cell *matCellDef="let expense">
            <div align="center">{{ expense.productId }}</div>
          </td>
          <td mat-footer-cell *matFooterCellDef></td>
        </ng-container>
      
        <!-- Description Column -->
        <ng-container matColumnDef="quantity">
          <th mat-header-cell *matHeaderCellDef>
            <div align="center">Description</div>
          </th>
          <td mat-cell *matCellDef="let expense">
            <div align="center">{{ expense.quantity  }}</div>
          </td>
          <td mat-footer-cell *matFooterCellDef></td>
        </ng-container>
      
        <!-- Amount Column -->
        <ng-container matColumnDef="cost">
          <th mat-header-cell *matHeaderCellDef>
            <div align="center">Cost</div>
          </th>
          <td mat-cell *matCellDef="let expense">
            <div align="right">
              {{ costOfProduct(expense.productId)  | currency : '$' }}
            </div>
          </td>
          <td mat-footer-cell *matFooterCellDef>
            <div align="right">
              <strong>
                        <div>Subtotal: {{ subtotalCost() | currency:'$' }}</div>
            <div>Tax: {{ totalTax() | currency:'$' }}</div>
            <div><strong>Total: {{ totalCost() | currency:'$' }}</strong></div>
              </strong>
            </div>
          </td>
          
        </ng-container>
              
      </table>
              
    </div>
  <div class="section">
      <button mat-raised-button type="button" style="color: green" (click)="saveReport()" >
        Save Report
      </button>
    </div>
  }
             
    


	@if (reportCreatedMessage() != '') {
      
    <div class="section">
      <h3>{{ reportCreatedMessage() }}</h3>
    </div>
      
    }
  </mat-card-content>
</mat-card>